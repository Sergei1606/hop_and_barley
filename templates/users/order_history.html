{% extends 'base.html' %}

{% block title %}–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ - Hop & Barley{% endblock %}

{% block content %}
<div class="orders-container" style="max-width: 1000px; margin: 0 auto;">
    <h1>üì¶ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h1>

    <div style="margin: 20px 0;">
        <a href="{% url 'users:profile' %}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –≤ –ø—Ä–æ—Ñ–∏–ª—å</a>
        <a href="{% url 'products:product_list' %}" class="btn btn-secondary">üõçÔ∏è –ö –ø–æ–∫—É–ø–∫–∞–º</a>
    </div>

    {% if orders %}
    <div class="orders-list">
        {% for order in orders %}
        <div class="order-card" style="border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <div>
                    <h3 style="margin: 0;">–ó–∞–∫–∞–∑ #{{ order.id }}</h3>
                    <small style="color: #666;">{{ order.created_at|date:"d.m.Y H:i" }}</small>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 1.2em; font-weight: bold; color: green;">{{ order.total_price }} —Ä—É–±.</div>
                    <div style="background:
                        {% if order.status == 'delivered' %}#d4edda
                        {% elif order.status == 'cancelled' %}#f8d7da
                        {% elif order.status == 'shipped' %}#cce5ff
                        {% elif order.status == 'paid' %}#fff3cd
                        {% else %}#e2e3e5{% endif %};
                        color:
                        {% if order.status == 'delivered' %}#155724
                        {% elif order.status == 'cancelled' %}#721c24
                        {% elif order.status == 'shipped' %}#004085
                        {% elif order.status == 'paid' %}#856404
                        {% else %}#383d41{% endif %};
                        padding: 4px 12px; border-radius: 4px; display: inline-block;">
                        {{ order.get_status_display }}
                    </div>
                </div>
            </div>

            <div style="margin: 15px 0;">
                <p><strong>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {{ order.shipping_address }}</p>
                <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ order.phone }}</p>
                <p><strong>Email:</strong> {{ order.email }}</p>
            </div>

            <div class="order-items">
                <h4>–¢–æ–≤–∞—Ä—ã:</h4>
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f5f5f5;">
                            <th style="padding: 10px; text-align: left;">–¢–æ–≤–∞—Ä</th>
                            <th style="padding: 10px; text-align: center;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                            <th style="padding: 10px; text-align: right;">–¶–µ–Ω–∞</th>
                            <th style="padding: 10px; text-align: right;">–°—É–º–º–∞</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in order.items.all %}
                        <tr style="border-bottom: 1px solid #eee;">
                            <td style="padding: 10px;">{{ item.product.name }}</td>
                            <td style="padding: 10px; text-align: center;">{{ item.quantity }} —à—Ç.</td>
                            <td style="padding: 10px; text-align: right;">{{ item.price }} —Ä—É–±.</td>
                            <td style="padding: 10px; text-align: right;">{{ item.get_total }} —Ä—É–±.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3" style="padding: 10px; text-align: right; font-weight: bold;">–ò—Ç–æ–≥–æ:</td>
                            <td style="padding: 10px; text-align: right; font-weight: bold;">{{ order.total_price }} —Ä—É–±.</td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <a href="{% url 'users:order_detail' order.id %}" class="btn btn-primary">
                    –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –∑–∞–∫–∞–∑–µ
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-orders" style="text-align: center; padding: 40px; background: #f9f9f9; border-radius: 8px;">
        <h2>üì≠ –ó–∞–∫–∞–∑–æ–≤ –Ω–µ—Ç</h2>
        <p>–í—ã –µ—â–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∞–ª–∏ –ø–æ–∫—É–ø–æ–∫ –≤ –Ω–∞—à–µ–º –º–∞–≥–∞–∑–∏–Ω–µ.</p>
        <a href="{% url 'products:product_list' %}" class="btn btn-primary">
            –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º
        </a>
    </div>
    {% endif %}
</div>

<style>
    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        margin-right: 10px;
    }
    .btn-primary {
        background: #4CAF50;
        color: white;
    }
    .btn-primary:hover {
        background: #45a049;
    }
    .btn-secondary {
        background: #ddd;
        color: #333;
    }
    .btn-secondary:hover {
        background: #ccc;
    }
</style>
{% endblock %}