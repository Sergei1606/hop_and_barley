{% extends 'base.html' %}

{% block title %}–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å - Hop & Barley{% endblock %}

{% block content %}
<div class="profile-container" style="max-width: 900px; margin: 0 auto;">
    <h1>üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h1>

    <div style="display: flex; gap: 30px; margin-top: 20px;">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
        <div style="flex: 1;">
            <h2>–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>

            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}

                <h3>–û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
                {% for field in user_form %}
                <div class="form-group">
                    <label>{{ field.label }}</label>
                    {{ field }}
                    {% if field.errors %}
                    <div class="error-message">{{ field.errors }}</div>
                    {% endif %}
                </div>
                {% endfor %}

                <h3 style="margin-top: 30px;">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                {% for field in profile_form %}
                <div class="form-group">
                    <label>{{ field.label }}</label>
                    {{ field }}
                    {% if field.errors %}
                    <div class="error-message">{{ field.errors }}</div>
                    {% endif %}
                </div>
                {% endfor %}

                <div class="form-group" style="margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                    <a href="{% url 'users:change_password' %}" class="btn btn-secondary">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</a>
                </div>
            </form>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –∑–∞–∫–∞–∑—ã –∏ –º–µ–Ω—é -->
        <div style="flex: 1;">
            <div class="profile-actions" style="background: #f5f5f5; padding: 20px; border-radius: 8px;">
                <h3>üìã –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="margin: 10px 0;">
                        <a href="{% url 'users:order_history' %}" class="btn btn-secondary" style="display: block; text-align: center;">
                            üì¶ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤
                        </a>
                    </li>
                    <li style="margin: 10px 0;">
                        <a href="{% url 'users:addresses' %}" class="btn btn-secondary" style="display: block; text-align: center;">
                            üè† –ú–æ–∏ –∞–¥—Ä–µ—Å–∞
                        </a>
                    </li>
                    <li style="margin: 10px 0;">
                        <a href="{% url 'products:product_list' %}" class="btn btn-secondary" style="display: block; text-align: center;">
                            üõçÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
                        </a>
                    </li>
                    <li style="margin: 10px 0;">
                        <a href="{% url 'users:logout' %}" class="btn btn-secondary" style="display: block; text-align: center; background: #ff4444;">
                            üö™ –í—ã–π—Ç–∏
                        </a>
                    </li>
                </ul>
            </div>

            {% if orders %}
            <div class="recent-orders" style="margin-top: 30px;">
                <h3>üïê –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h3>
                {% for order in orders %}
                <div class="order-item" style="border: 1px solid #ddd; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                    <div style="display: flex; justify-content: space-between;">
                        <div>
                            <strong>–ó–∞–∫–∞–∑ #{{ order.id }}</strong><br>
                            <small>{{ order.created_at|date:"d.m.Y H:i" }}</small>
                        </div>
                        <div>
                            <span style="color: green; font-weight: bold;">{{ order.total_price }} —Ä—É–±.</span><br>
                            <span style="background: #e0e0e0; padding: 2px 8px; border-radius: 4px; font-size: 12px;">
                                {{ order.get_status_display }}
                            </span>
                        </div>
                    </div>
                    <div style="margin-top: 10px;">
                        <a href="{% url 'users:order_detail' order.id %}" class="btn btn-secondary" style="padding: 5px 10px; font-size: 14px;">
                            –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí
                        </a>
                    </div>
                </div>
                {% endfor %}

                <div style="text-align: center; margin-top: 15px;">
                    <a href="{% url 'users:order_history' %}" class="btn btn-secondary">
                        –í—Å—è –∏—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤
                    </a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
    .form-group {
        margin-bottom: 15px;
    }
    .form-input {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        margin-top: 5px;
    }
    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        margin-right: 10px;
    }
    .btn-primary {
        background: #4CAF50;
        color: white;
    }
    .btn-primary:hover {
        background: #45a049;
    }
    .btn-secondary {
        background: #ddd;
        color: #333;
    }
    .btn-secondary:hover {
        background: #ccc;
    }
    .error-message {
        color: #ff4444;
        font-size: 12px;
        margin-top: 5px;
    }
</style>
{% endblock %}